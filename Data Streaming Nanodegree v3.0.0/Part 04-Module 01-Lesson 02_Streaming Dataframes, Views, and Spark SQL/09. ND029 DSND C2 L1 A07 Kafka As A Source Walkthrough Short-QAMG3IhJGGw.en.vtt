WEBVTT
Kind: captions
Language: en

00:00:00.000 --> 00:00:05.160
The first thing I'm going to do is make sure that spark and Kafka are running with PS-EF.

00:00:05.160 --> 00:00:06.450
When I run that command,

00:00:06.450 --> 00:00:11.615
I see several Java processes running and if I look,

00:00:11.615 --> 00:00:13.965
I see spark running in two of those.

00:00:13.965 --> 00:00:15.885
I have Kafka, which are the others,

00:00:15.885 --> 00:00:17.925
and then these two are Spark.

00:00:17.925 --> 00:00:19.155
So we're good to go.

00:00:19.155 --> 00:00:21.125
I'm going to clear my console.

00:00:21.125 --> 00:00:25.080
Here's the solution for the exercise.

00:00:25.480 --> 00:00:28.550
We're going to import the Spark session.

00:00:28.550 --> 00:00:32.885
We're going to create a spark session then we're going to set the log level to one.

00:00:32.885 --> 00:00:37.115
We're going to read a Data Frame from Kafka by saying the bootstrap server,

00:00:37.115 --> 00:00:40.955
the topic, and the starting offset.

00:00:40.955 --> 00:00:44.035
Then I'm going to select from

00:00:44.035 --> 00:00:50.265
the data frame and cast that data to strings both the key and the value.

00:00:50.265 --> 00:00:56.360
Then I'm going to write those fields to the console and if I go to home,

00:00:56.360 --> 00:01:01.140
workspace, spark, nls, I have my scripts.

00:01:01.140 --> 00:01:03.425
I'm going to submit,

00:01:03.425 --> 00:01:10.295
Kafka, console dot solution dot SH.

00:01:10.295 --> 00:01:13.910
The blinking cursor means a spark code is running

00:01:13.910 --> 00:01:19.880
now and now we see the data coming from Kafka with keys and values.

00:01:19.880 --> 00:01:22.895
The fuel level has a key of a truck number

00:01:22.895 --> 00:01:26.720
and a value of the percentage full of the fuel tank.

00:01:26.720 --> 00:01:30.030
I'm going to kill this by saying Control-C.

