WEBVTT
Kind: captions
Language: zh-CN

00:00:07.490 --> 00:00:11.070
我们刚讨论了如何存储大量数据文件

00:00:11.070 --> 00:00:13.155
以及数据的格式

00:00:13.154 --> 00:00:16.664
接下来让我们来看看 Spark 程序长啥样

00:00:16.664 --> 00:00:21.149
每个 Spark 程序的第一个组件是 SparkContext

00:00:21.149 --> 00:00:23.879
SparkContext 是使用

00:00:23.879 --> 00:00:27.869
Spark 功能以及将群集与应用程序连接起来的主要入口

00:00:27.870 --> 00:00:30.975
如果想使用比较底层的抽象

00:00:30.975 --> 00:00:33.704
我们就用 SparkContext 来创建对象

00:00:33.704 --> 00:00:35.579
要创建 SparkContext

00:00:35.579 --> 00:00:38.519
我们首先需要创建一个 SparkConf 对象来明确

00:00:38.520 --> 00:00:40.620
关于应用的一些信息

00:00:40.619 --> 00:00:44.929
例如它的名称和主节点的 IP 地址

00:00:44.929 --> 00:00:47.119
如果我们使用单机模式运行 Spark

00:00:47.119 --> 00:00:50.809
我们可以把字符串 local 作为 master

00:00:50.810 --> 00:00:54.815
我们要使用 Spark sql 里的 SparkSession

00:00:54.814 --> 00:00:58.079
来读取数据表

00:00:58.079 --> 00:00:59.960
与 SparkConf 类似

00:00:59.960 --> 00:01:03.785
创建 SparkSession 时 我们要先明确一些参数

00:01:03.784 --> 00:01:08.810
例如 GetOrCreate 意味着如果你有在运行的 SparkSession

00:01:08.810 --> 00:01:10.670
那 Spark 就不会新建一个 

00:01:10.670 --> 00:01:12.710
而是返回旧的 SparkSession 

00:01:12.709 --> 00:01:16.919
旧的参数会被更新为新的参数

